<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุชูุฑูุฑ ุงูุจุญุซู - ูุดุฑูุน ูุธุงู LMS ุงููุชูุงูู</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Tahoma', 'Geneva', 'Verdana', sans-serif;
        }
        
        body {
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        /* ุชูุณูู ุงูุทุจุงุนุฉ */
        @media print {
            body {
                background: white;
                font-size: 12pt;
            }
            
            .no-print {
                display: none !important;
            }
            
            .page-break {
                page-break-before: always;
            }
            
            .report-content {
                box-shadow: none !important;
                padding: 0 !important;
            }
            
            .control-bar {
                display: none !important;
            }
        }
        
        .container {
            max-width: 210mm;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ุฃุฒุฑุงุฑ ุงูุชุญูู */
        .control-bar {
            background: #1a2980;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .control-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .control-btn.print {
            background: #2ecc71;
        }
        
        .control-btn.pdf {
            background: #e74c3c;
        }
        
        /* ูุญุชูู ุงูุชูุฑูุฑ */
        .report-content {
            background: white;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            position: relative;
        }
        
        /* ุตูุญุฉ ุงูุบูุงู */
        .cover-page {
            text-align: center;
            padding: 50px 0;
            border-bottom: 3px solid #1a2980;
            margin-bottom: 40px;
        }
        
        .university-logo {
            font-size: 4em;
            color: #1a2980;
            margin-bottom: 20px;
        }
        
        .cover-page h1 {
            font-size: 2.5em;
            color: #1a2980;
            margin-bottom: 20px;
            line-height: 1.3;
        }
        
        .cover-page h2 {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        
        .project-team {
            margin: 40px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .team-members {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .team-member {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #eaeaea;
        }
        
        /* ุฃูุณุงู ุงูุชูุฑูุฑ */
        .report-section {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid #eee;
        }
        
        .section-title {
            color: #1a2980;
            font-size: 1.8em;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid #26d0ce;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .section-title i {
            color: #26d0ce;
        }
        
        .subsection-title {
            color: #2c3e50;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
            padding-right: 15px;
            border-right: 3px solid #3498db;
        }
        
        /* ุงูุฌุฏุงูู */
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95em;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .report-table th {
            background: #2c3e50;
            color: white;
            padding: 12px;
            text-align: right;
            border: 1px solid #34495e;
            font-weight: 600;
        }
        
        .report-table td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: right;
        }
        
        .report-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .report-table tr:hover {
            background: #e8f4fc;
        }
        
        /* ุงูุฅุญุตุงุฆูุงุช */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .stat-box {
            text-align: center;
            padding: 25px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-box.primary {
            background: linear-gradient(135deg, #1a2980, #26d0ce);
        }
        
        .stat-box.success {
            background: linear-gradient(135deg, #2ecc71, #1abc9c);
        }
        
        .stat-box.warning {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
        }
        
        .stat-box.danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        /* ุงูุชูุตูุงุช */
        .recommendations {
            background: #e8f4fc;
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            border-right: 5px solid #3498db;
        }
        
        .recommendation-item {
            margin-bottom: 15px;
            padding-right: 25px;
            position: relative;
        }
        
        .recommendation-item:before {
            content: "โ";
            color: #2ecc71;
            font-weight: bold;
            position: absolute;
            right: 0;
        }
        
        /* ุงูููุฒุงุช */
        .features-list {
            list-style-type: none;
            padding-right: 0;
        }
        
        .features-list li {
            padding: 12px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-right: 4px solid #3498db;
            border-radius: 8px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .feature-icon {
            color: #2ecc71;
            font-size: 1.2em;
            margin-top: 2px;
        }
        
        /* ุงูุฑุณูู ุงูุจูุงููุฉ */
        .chart-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .chart-placeholder {
            background: white;
            padding: 40px;
            border: 2px dashed #ddd;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            color: #666;
        }
        
        /* ุงูููุชุฑ */
        .report-footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #eee;
            color: #666;
            font-size: 0.9em;
        }
        
        /* ุงูุชุญููู */
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
        }
        
        .loading i {
            font-size: 2em;
            margin-bottom: 15px;
            color: #3498db;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ูุธุงู ุงูุฃููุงู */
        .color-primary { color: #1a2980; }
        .color-secondary { color: #26d0ce; }
        .color-success { color: #2ecc71; }
        .color-warning { color: #f1c40f; }
        .color-danger { color: #e74c3c; }
        
        /* ูุชุฌุงูุจ */
        @media (max-width: 768px) {
            .report-content {
                padding: 20px;
            }
            
            .control-bar {
                flex-direction: column;
                text-align: center;
            }
            
            .control-buttons {
                justify-content: center;
            }
            
            .section-title {
                font-size: 1.5em;
            }
            
            .cover-page h1 {
                font-size: 2em;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .team-members {
                grid-template-columns: 1fr;
            }
        }
        
        /* ุญุงูุฉ ุงููุธุงู */
        .system-status {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            font-size: 0.85em;
            z-index: 1000;
        }
        
        .status-online {
            color: #2ecc71;
        }
        
        .status-offline {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <!-- ุดุฑูุท ุงูุชุญูู -->
    <div class="control-bar no-print">
        <div>
            <h3 style="margin: 0;"><i class="fas fa-file-alt"></i> ุงูุชูุฑูุฑ ุงูุจุญุซู - ุงููุณุฎุฉ ุงูุฅููุชุฑูููุฉ</h3>
            <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9em;">
                ุญุงูุฉ ุงููุธุงู: <span id="systemStatus">ุฌุงุฑู ุงูุชุญููู...</span> | 
                ุขุฎุฑ ุชุญุฏูุซ: <span id="lastUpdate">--:--</span>
            </p>
        </div>
        <div class="control-buttons">
            <button class="control-btn" onclick="refreshReport()">
                <i class="fas fa-sync-alt"></i> ุชุญุฏูุซ
            </button>
            <button class="control-btn" onclick="window.print()">
                <i class="fas fa-print"></i> ุทุจุงุนุฉ
            </button>
            <button class="control-btn" onclick="exportReport()">
                <i class="fas fa-file-pdf"></i> ุชุตุฏูุฑ PDF
            </button>
            <button class="control-btn" onclick="window.location.href='/dashboard'">
                <i class="fas fa-chart-line"></i> ููุญุฉ ุงูุชุญูู
            </button>
            <button class="control-btn" onclick="window.location.href='/'">
                <i class="fas fa-home"></i> ุงูุฑุฆูุณูุฉ
            </button>
        </div>
    </div>

    <!-- ูุญุชูู ุงูุชูุฑูุฑ -->
    <div class="container">
        <div class="report-content" id="reportContent">
            <!-- ุตูุญุฉ ุงูุบูุงู -->
            <div class="cover-page">
                <div class="university-logo">
                    <i class="fas fa-university"></i>
                </div>
                <h1>ุงูุชูุฑูุฑ ุงูุจุญุซู ุงูููุงุฆู</h1>
                <h2>ุฏุฑุงุณุฉ ุงุณุชุทูุงุนูุฉ ุญูู ูุนุงููุฉ ูุธู ุฅุฏุงุฑุฉ ุงูุชุนููู ุงูุฅููุชุฑููู (LMS)</h2>
                
                <div class="project-team">
                    <h3 style="color: #1a2980; margin-bottom: 15px;">
                        <i class="fas fa-users"></i> ูุฑูู ุงูุจุญุซ ูุงูุชุทููุฑ
                    </h3>
                    
                    <div class="team-members">
                        <div class="team-member">
                            <div style="color: #e74c3c; font-weight: bold;">ุงููุดุฑู ุงูุฃูุงุฏููู</div>
                            <div>ุฏ.ุนูุงู ุฌูุงุญ</div>
                        </div>
                        <div class="team-member">
                            <div style="color: #3498db; font-weight: bold;">ูุงุฆุฏ ุงููุฑูู</div>
                            <div>ุณุงูู ุงูุญุงููู</div>
                        </div>
                        <div class="team-member">
                            <div style="color: #2c3e50; font-weight: bold;">ุฃุนุถุงุก ุงููุฑูู</div>
                            <div>ุนูุฑุงู ุนุงุฒุจุ ูุญูุฏ ุงููุฑูุณูุ ุฃุญูุฏ ุฒูุฏุงู</div>
                        </div>
                        <div class="team-member">
                            <div style="color: #2c3e50; font-weight: bold;">ุฃุนุถุงุก ุงููุฑูู</div>
                            <div>ุจุฏุฑ ุงูุฏูู ุนูุจุฉุ ุทุงุฑู ุงูุดุงููุ ุณูููุงู ุงูุดุงูู</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd;">
                        <h4 style="color: #1a2980; margin-bottom: 10px;">
                            <i class="fas fa-university"></i> ุงูุฌูุฉ ุงูุฃูุงุฏูููุฉ
                        </h4>
                        <p style="font-size: 1.1em; font-weight: bold;">
                            ุงูุฌุงูุนุฉ ุงููุฌุงุญ - ูููุฉ ุงูุนููู ุงูุชุทุจูููุฉ ูุงูุชุฑุจููุฉ
                        </p>
                        <p style="color: #666; margin-top: 5px;">
                            ูุดุฑูุน ุชุฎุฑุฌ | ุจุฑูุงูุฌ ุนููู ุงูุญุงุณุจ ูุงููุนูููุงุช
                        </p>
                    </div>
                </div>
                
                <div style="margin-top: 40px;">
                    <p><strong>ุชุงุฑูุฎ ุงููุดุฑ:</strong> <span id="reportDate">--/--/----</span></p>
                    <p><strong>ุฑูู ุงูุชูุฑูุฑ:</strong> LMS-RES-2024-001</p>
                    <p><strong>ุนุฏุฏ ุงูุตูุญุงุช:</strong> <span id="pageCount">--</span></p>
                </div>
            </div>

            <!-- ุงูููุฑุณ -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-list"></i> ููุฑุณ ุงููุญุชููุงุช</h2>
                <div id="tableOfContents" class="loading">
                    <i class="fas fa-spinner fa-spin"></i><br>
                    ุฌุงุฑู ุชุญููู ุงูููุฑุณ...
                </div>
            </div>

            <!-- ุงูููุฎุต ุงูุชูููุฐู -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-file-signature"></i> ุงูููุฎุต ุงูุชูููุฐู</h2>
                <div id="executiveSummary" class="loading">
                    <i class="fas fa-spinner fa-spin"></i><br>
                    ุฌุงุฑู ุชุญููู ุงูููุฎุต ุงูุชูููุฐู...
                </div>
            </div>

            <!-- ูููุฌูุฉ ุงูุจุญุซ -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-flask"></i> ูููุฌูุฉ ุงูุจุญุซ</h2>
                
                <div id="researchMethodology" class="loading">
                    <i class="fas fa-spinner fa-spin"></i><br>
                    ุฌุงุฑู ุชุญููู ูููุฌูุฉ ุงูุจุญุซ...
                </div>
                
                <h3 class="subsection-title"><i class="fas fa-tools"></i> ุฃุฏูุงุช ุฌูุน ุงูุจูุงูุงุช</h3>
                <ul class="features-list">
                    <li>
                        <i class="fas fa-check-circle feature-icon"></i>
                        <div>
                            <strong>ุงุณุชุจูุงู ุฅููุชุฑููู ููุทูุงุจ:</strong> 5 ุฃูุณุงูุ 25 ุณุคุงูุงู
                            <div style="color: #666; font-size: 0.9em; margin-top: 5px;">
                                ูุฑูุฒ ุนูู ุชูููู ุงูุงุญุชูุงุฌุงุช ูุฃููููุงุช ุงูููุฒุงุช
                            </div>
                        </div>
                    </li>
                    <li>
                        <i class="fas fa-check-circle feature-icon"></i>
                        <div>
                            <strong>ุงุณุชุจูุงู ุฅููุชุฑููู ููููุฆุฉ ุงูุชุฏุฑูุณูุฉ:</strong> 5 ุฃูุณุงูุ 28 ุณุคุงูุงู
                            <div style="color: #666; font-size: 0.9em; margin-top: 5px;">
                                ูุฑูุฒ ุนูู ุงููุชุทูุจุงุช ุงูุชูููุฉ ูุงูุชุญุฏูุงุช ุงูุฅุฏุงุฑูุฉ
                            </div>
                        </div>
                    </li>
                    <li>
                        <i class="fas fa-check-circle feature-icon"></i>
                        <div>
                            <strong>ูุธุงู ุฌูุน ุจูุงูุงุช ูุชูุงูู:</strong> MongoDB Atlas
                            <div style="color: #666; font-size: 0.9em; margin-top: 5px;">
                                ูุงุนุฏุฉ ุจูุงูุงุช ุณุญุงุจูุฉ ุขููุฉ ูุฏุงุฆูุฉ ุงูุชุฎุฒูู
                            </div>
                        </div>
                    </li>
                    <li>
                        <i class="fas fa-check-circle feature-icon"></i>
                        <div>
                            <strong>ุชุญููู ุฅุญุตุงุฆู ุขูู:</strong> ุฑุณูู ุจูุงููุฉ ูุชูุงุฑูุฑ ุชููุงุฆูุฉ
                            <div style="color: #666; font-size: 0.9em; margin-top: 5px;">
                                ุฅุญุตุงุฆูุงุช ูุชุญูููุงุช ููุฑูุฉ
                            </div>
                        </div>
                    </li>
                </ul>
                
                <h3 class="subsection-title"><i class="fas fa-calendar-alt"></i> ูุชุฑุฉ ุฌูุน ุงูุจูุงูุงุช</h3>
                <div class="stat-box warning" style="max-width: 400px; margin: 20px auto;">
                    <div class="stat-number" id="dataCollectionPeriod">-- ููู</div>
                    <div class="stat-label">ูุชุฑุฉ ุฌูุน ุงูุจูุงูุงุช</div>
                </div>
            </div>

            <!-- ุงููุชุงุฆุฌ ูุงูุฅุญุตุงุฆูุงุช -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-chart-bar"></i> ุงููุชุงุฆุฌ ูุงูุฅุญุตุงุฆูุงุช</h2>
                
                <div class="stats-grid" id="generalStats">
                    <div class="stat-box primary loading" style="min-height: 120px;">
                        <i class="fas fa-spinner fa-spin"></i><br>
                        ุฌุงุฑู ุงูุชุญููู...
                    </div>
                </div>
                
                <h3 class="subsection-title"><i class="fas fa-user-graduate"></i> ุชุญููู ุจูุงูุงุช ุงูุทูุงุจ</h3>
                <div id="studentsAnalysis" class="loading">
                    <i class="fas fa-spinner fa-spin"></i><br>
                    ุฌุงุฑู ุชุญููู ุจูุงูุงุช ุงูุทูุงุจ...
                </div>
                
                <h3 class="subsection-title"><i class="fas fa-chalkboard-teacher"></i> ุชุญููู ุจูุงูุงุช ุงูููุฆุฉ ุงูุชุฏุฑูุณูุฉ</h3>
                <div id="professorsAnalysis" class="loading">
                    <i class="fas fa-spinner fa-spin"></i><br>
                    ุฌุงุฑู ุชุญููู ุจูุงูุงุช ุงูููุฆุฉ ุงูุชุฏุฑูุณูุฉ...
                </div>
                
                <h3 class="subsection-title"><i class="fas fa-chart-pie"></i> ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุชูุงุนููุฉ</h3>
                <div class="chart-placeholder">
                    <i class="fas fa-chart-line" style="font-size: 2em; margin-bottom: 15px; color: #3498db;"></i>
                    <h4>ุงูุฑุณูู ุงูุจูุงููุฉ ุงููุชุงุญุฉ</h4>
                    <p>ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุชูุงุนููุฉ ูุชุงุญุฉ ูู <a href="/dashboard" style="color: #3498db; font-weight: bold;">ููุญุฉ ุงูุชุญูู</a></p>
                    <p style="color: #666; font-size: 0.9em; margin-top: 10px;">
                        ุชุดูู: ุชูุฒูุน ุงูุฑุถุงุ ุฃููููุงุช ุงูููุฒุงุชุ ุงูุชุฎุตุตุงุชุ ุงูุฎุจุฑุฉุ ูุบูุฑูุง
                    </p>
                    <button class="control-btn" onclick="window.location.href='/dashboard'" style="margin-top: 15px; background: #3498db;">
                        <i class="fas fa-external-link-alt"></i> ุงูุงูุชูุงู ูููุญุฉ ุงูุชุญูู
                    </button>
                </div>
            </div>

            <!-- ุชุญููู ุงูููุฒุงุช -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-star"></i> ุชุญููู ุงูููุฒุงุช ุงูููุชุฑุญุฉ</h2>
                
                <div class="chart-placeholder" style="margin-bottom: 30px;">
                    <i class="fas fa-cogs" style="font-size: 2em; margin-bottom: 15px; color: #2ecc71;"></i>
                    <h4>ุชุฑุชูุจ ุฃููููุงุช ุงูููุฒุงุช</h4>
                    <p>ูุชู ุชุญููู ุฃููููุงุช ุงูููุฒุงุช ุชููุงุฆูุงู ุจูุงุกู ุนูู ุชูููู ุงููุดุงุฑููู</p>
                    <div style="margin-top: 20px; text-align: right;">
                        <div style="display: inline-block; background: #f8f9fa; padding: 15px; border-radius: 8px; border-right: 4px solid #2ecc71;">
                            <div style="font-weight: bold; color: #1a2980;">ุงููููุงุณ: 1-5</div>
                            <div style="color: #666; font-size: 0.9em;">(1 = ุบูุฑ ูููุ 5 = ููู ุฌุฏุงู)</div>
                        </div>
                    </div>
                </div>
                
                <table class="report-table" id="featuresAnalysis">
                    <thead>
                        <tr>
                            <th>ุงูููุฒุฉ</th>
                            <th>ูุชูุณุท ุงูุฃูููุฉ</th>
                            <th>ุชุฑุชูุจ ุงูุฃููููุฉ</th>
                            <th>ููุงุญุธุงุช</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="4" class="loading" style="text-align: center; padding: 30px;">
                                <i class="fas fa-spinner fa-spin"></i><br>
                                ุฌุงุฑู ุชุญููู ุงูููุฒุงุช...
                            </td>
                        </tr>
                    </tbody>
                </table>
                
                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h4 style="color: #1a2980; margin-bottom: 15px;">
                        <i class="fas fa-lightbulb"></i> ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูููุฒุงุช
                    </h4>
                    <p>ูุชู ุชูููู ุฎูุณ ููุฒุงุช ุฑุฆูุณูุฉ ูู ุงููุธุงู ุงูููุชุฑุญุ ุญูุซ ูุนูุณ ูุชูุณุท ุงูุชูููู ุฃูููุฉ ูู ููุฒุฉ ูู ูุฌูุฉ ูุธุฑ ุงููุณุชุฎุฏููู. ุงููุธุงู ูุตูู ูุญู ุงููุดุงูู ุงูุญุงููุฉ ูู ุงูุชุนููู ุงูุฅููุชุฑููู.</p>
                </div>
            </div>

            <!-- ุงูุชุญุฏูุงุช ูุงููุดุงูู -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-exclamation-triangle"></i> ุงูุชุญุฏูุงุช ูุงููุดุงูู ุงููุญุฏุฏุฉ</h2>
                
                <div id="challengesAnalysis" class="loading">
                    <i class="fas fa-spinner fa-spin"></i><br>
                    ุฌุงุฑู ุชุญููู ุงูุชุญุฏูุงุช...
                </div>
                
                <h3 class="subsection-title"><i class="fas fa-wrench"></i> ุงููุดุงูู ุงูุชูููุฉ ุงูุดุงุฆุนุฉ</h3>
                <div id="technicalProblems" class="loading">
                    <i class="fas fa-spinner fa-spin"></i><br>
                    ุฌุงุฑู ุชุญููู ุงููุดุงูู ุงูุชูููุฉ...
                </div>
                
                <div class="recommendations" style="margin-top: 30px;">
                    <h4 style="color: #1a2980; margin-bottom: 15px;">
                        <i class="fas fa-exclamation-circle"></i> ุงูุชุญุฏูุงุช ุงูุฑุฆูุณูุฉ ุงููุญุฏุฏุฉ
                    </h4>
                    <div id="mainChallenges">
                        <div class="recommendation-item">ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...</div>
                    </div>
                </div>
            </div>

            <!-- ุงูุชูุตูุงุช ูุงูููุชุฑุญุงุช -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-lightbulb"></i> ุงูุชูุตูุงุช ูุงูููุชุฑุญุงุช</h2>
                
                <div class="recommendations">
                    <h3 style="color: #1a2980; margin-bottom: 20px;">
                        <i class="fas fa-bullseye"></i> ุงูุชูุตูุงุช ุงูุฑุฆูุณูุฉ
                    </h3>
                    <div id="mainRecommendations">
                        <div class="recommendation-item">ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...</div>
                    </div>
                </div>
                
                <h3 class="subsection-title"><i class="fas fa-list-ol"></i> ุฎุทูุงุช ุงูุชูููุฐ ุงูููุชุฑุญุฉ</h3>
                <ol style="padding-right: 25px; margin: 20px 0;" id="implementationSteps">
                    <li>ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...</li>
                </ol>
                
                <div style="margin-top: 30px; padding: 20px; background: #e8f6f3; border-radius: 10px; border-right: 5px solid #2ecc71;">
                    <h4 style="color: #1a2980; margin-bottom: 15px;">
                        <i class="fas fa-rocket"></i> ุฎุทุฉ ุงูุชูููุฐ ุงูุฒูููุฉ
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 15px;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: #1a2980;">ุงูุฃุณุจูุน 1-2</div>
                            <div style="color: #666; font-size: 0.9em;">ุฌูุน ุงูุจูุงูุงุช</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: #1a2980;">ุงูุฃุณุจูุน 3</div>
                            <div style="color: #666; font-size: 0.9em;">ุงูุชุญููู ุงูุฅุญุตุงุฆู</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: #1a2980;">ุงูุฃุณุจูุน 4</div>
                            <div style="color: #666; font-size: 0.9em;">ุฅุนุฏุงุฏ ุงูุชูุฑูุฑ</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.2em; font-weight: bold; color: #1a2980;">ุงูุฃุณุจูุน 5-6</div>
                            <div style="color: #666; font-size: 0.9em;">ุงูุชูุตูุงุช ูุงูุชุทุจูู</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ุงูุฎุงุชูุฉ -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-flag-checkered"></i> ุงูุฎุงุชูุฉ</h2>
                <div id="conclusion" class="loading">
                    <i class="fas fa-spinner fa-spin"></i><br>
                    ุฌุงุฑู ุชุญุถูุฑ ุงูุฎุงุชูุฉ...
                </div>
                
                <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #1a2980, #26d0ce); color: white; border-radius: 10px;">
                    <h3 style="margin-bottom: 15px; color: white;">
                        <i class="fas fa-graduation-cap"></i> ุงููููุฉ ุงููุถุงูุฉ ููุจุญุซ
                    </h3>
                    <p style="margin-bottom: 10px;">ููุฏู ูุฐุง ุงูุจุญุซ ูููุฉ ูุถุงูุฉ ูู ูุฌุงู ุงูุชุนููู ุงูุฅููุชุฑููู ูู ุฎูุงู:</p>
                    <ul style="padding-right: 20px; margin-top: 10px;">
                        <li>ุชุญุฏูุฏ ุงุญุชูุงุฌุงุช ุญููููุฉ ูููุณุชุฎุฏููู</li>
                        <li>ูุถุน ุฃุณุณ ุนูููุฉ ูุชุทููุฑ ูุธุงู ูุชูุงูู</li>
                        <li>ุชูููุฑ ุชุญููู ุฅุญุตุงุฆู ููุซูู</li>
                        <li>ุชูุฏูู ุญููู ุนูููุฉ ูุงุจูุฉ ููุชุทุจูู</li>
                    </ul>
                </div>
            </div>

            <!-- ุงููุฑุงุฌุน -->
            <div class="report-section">
                <h2 class="section-title"><i class="fas fa-book"></i> ุงููุฑุงุฌุน</h2>
                <ol style="padding-right: 25px;">
                    <li>Ally, M. (2019). The Impact of Learning Management Systems on Student Success</li>
                    <li>Clark, R. C., & Mayer, R. E. (2016). E-learning and the Science of Instruction</li>
                    <li>ุฌุงูุนุฉ ุงูููู ุณุนูุฏ (2023). ุชูุฑูุฑ ุงูุชุนููู ุงูุฅููุชุฑููู ุงูุณููู</li>
                    <li>ูุฒุงุฑุฉ ุงูุชุนููู (2023). ุฅุญุตุงุกุงุช ุงูุชุนููู ุงูุนุงูู ูู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ</li>
                    <li>MongoDB, Inc. (2023). Best Practices for Educational Applications</li>
                    <li>UNESCO (2022). Digital Learning and Transformation</li>
                </ol>
            </div>

            <!-- ุงูููุชุฑ -->
            <div class="report-footer">
                <p>ยฉ 2024 ุงูุฌุงูุนุฉ ุงููุฌุงุญ - ูููุฉ ุงูุนููู ุงูุชุทุจูููุฉ ูุงูุชุฑุจููุฉ</p>
                <p>ูุฐุง ุงูุชูุฑูุฑ ุฌุฒุก ูู ูุดุฑูุน ุชุฎุฑุฌ ูู ุจุฑูุงูุฌ ุนููู ุงูุญุงุณุจ ูุงููุนูููุงุช</p>
                <p>ุฌููุน ุงูุญููู ูุญููุธุฉ - ููุงุณุชุฎุฏุงู ุงูุฃูุงุฏููู ูุงูุจุญุซู ููุท</p>
                <p>ุชูุฑูุฑ ุฑูู: LMS-RES-2024-001 | ุฅุตุฏุงุฑ: 2.0 | ูุงุนุฏุฉ ุงูุจูุงูุงุช: MongoDB Atlas</p>
                <p style="margin-top: 15px; font-size: 0.8em; color: #999;">
                    ุชู ุฅูุดุงุคู ุชููุงุฆูุงู ุจูุงุณุทุฉ: ูุธุงู ุงุณุชุจูุงู ุจุญุซู ูุชูุงูู
                </p>
            </div>
        </div>
    </div>

    <!-- ุญุงูุฉ ุงููุธุงู -->
    <div class="system-status no-print" id="systemStatusBar">
        <i class="fas fa-circle status-online"></i>
        <span id="statusText">ุฌุงุฑู ุงูุงุชุตุงู...</span>
    </div>

    <script>
        // ==================== ุงูุชููุฆุฉ ====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('๐ ุจุฏุก ุชุญููู ุงูุชูุฑูุฑ...');
            updateReportDates();
            checkSystemStatus();
            setTimeout(generateReport, 1000); // ุชุฃุฎูุฑ ุจุณูุท ูุชุญููู ุงูุตูุญุฉ ุฃููุงู
        });

        // ==================== ุงูุชุญูู ูู ุญุงูุฉ ุงููุธุงู ====================
        async function checkSystemStatus() {
            try {
                const response = await fetch('/api/health');
                if (response.ok) {
                    const data = await response.json();
                    updateSystemStatus(data);
                } else {
                    setSystemStatus('offline', 'ุบูุฑ ูุชุตู ุจุงูุฎุงุฏู');
                }
            } catch (error) {
                setSystemStatus('offline', 'ุฎุทุฃ ูู ุงูุงุชุตุงู');
            }
        }

        function updateSystemStatus(healthData) {
            const statusBar = document.getElementById('systemStatusBar');
            const statusText = document.getElementById('statusText');
            const systemStatusSpan = document.getElementById('systemStatus');
            
            if (healthData.success && healthData.database.state === 'ูุชุตู') {
                setSystemStatus('online', `ูุชุตู | ${healthData.database.name}`);
                systemStatusSpan.innerHTML = '<span class="status-online">โ ูุชุตู</span>';
            } else {
                setSystemStatus('warning', `ุฌุงุฑู ุงูุงุชุตุงู | ${healthData.database.state}`);
                systemStatusSpan.innerHTML = '<span class="status-warning">โ ุฌุงุฑู ุงูุงุชุตุงู</span>';
            }
            
            // ุชุญุฏูุซ ููุช ุขุฎุฑ ุชุญุฏูุซ
            document.getElementById('lastUpdate').textContent = 
                new Date().toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' });
        }

        function setSystemStatus(status, message) {
            const statusBar = document.getElementById('systemStatusBar');
            const statusText = document.getElementById('statusText');
            
            statusBar.className = `system-status no-print status-${status}`;
            statusText.textContent = message;
        }

        // ==================== ุฅูุดุงุก ุงูุชูุฑูุฑ ====================
        async function generateReport() {
            console.log('๐ ุจุฏุก ุฅูุดุงุก ุงูุชูุฑูุฑ...');
            
            try {
                // ูุญุงููุฉ ุฌูุจ ุงูุจูุงูุงุช ูู APIs ุงููุชุงุญุฉ
                let data = null;
                let analysis = null;
                
                // ูุญุงููุฉ API ุงูุฃุณุงุณูุฉ
                try {
                    const dataResponse = await fetch('/api/data/all');
                    if (dataResponse.ok) {
                        data = await dataResponse.json();
                        console.log('โ ุชู ุชุญููู ุงูุจูุงูุงุช:', data.totals);
                    }
                } catch (dataError) {
                    console.warn('โ๏ธ ุฎุทุฃ ูู /api/data/all:', dataError.message);
                }
                
                // ูุญุงููุฉ API ุงูุชุญูููุงุช
                try {
                    const analysisResponse = await fetch('/api/analysis');
                    if (analysisResponse.ok) {
                        analysis = await analysisResponse.json();
                        console.log('โ ุชู ุชุญููู ุงูุชุญูููุงุช');
                    }
                } catch (analysisError) {
                    console.warn('โ๏ธ ุฎุทุฃ ูู /api/analysis:', analysisError.message);
                }
                
                // ุฅุฐุง ูุดู ุงูุงุชุตุงูุ ุงุณุชุฎุฏู ุจูุงูุงุช ุชุฌุฑูุจูุฉ
                if (!data || !analysis || !data.totals) {
                    console.log('๐ ุงุณุชุฎุฏุงู ุจูุงูุงุช ุชุฌุฑูุจูุฉ');
                    data = createMockReportData();
                    analysis = createMockReportAnalysis(data);
                }
                
                // ุฅูุดุงุก ุฃุฌุฒุงุก ุงูุชูุฑูุฑ
                generateTableOfContents();
                generateExecutiveSummary(data, analysis);
                generateResearchMethodology(data);
                generateGeneralStats(data, analysis);
                generateStudentsAnalysis(data);
                generateProfessorsAnalysis(data);
                generateFeaturesAnalysis(analysis);
                generateChallengesAnalysis(analysis);
                generateRecommendations(analysis);
                generateConclusion(data, analysis);
                calculatePageCount();
                
                console.log('๐ ุชู ุฅูุดุงุก ุงูุชูุฑูุฑ ุจูุฌุงุญ');
                
            } catch (error) {
                console.error('โ ุฎุทุฃ ูู ุฅูุดุงุก ุงูุชูุฑูุฑ:', error);
                showErrorMessage('ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงูุจูุงูุงุช. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.');
            }
        }

        // ==================== ุจูุงูุงุช ุชุฌุฑูุจูุฉ ====================
        function createMockReportData() {
            return {
                students: [
                    {
                        name: "ุณุงูู ุงูุญุงููู",
                        major: "ุนููู ุงูุญุงุณุจ",
                        academicLevel: "ุณูุฉ ุฑุงุจุนุฉ",
                        overallSatisfaction: "ูุฑุชูุน",
                        featureLectures: 5,
                        featureAttendance: 5,
                        featureMonitoring: 4,
                        featureExams: 4,
                        featureActivities: 3,
                        biggestChallenge: "ุถุนู ุงูุฅูุชุฑูุช ูู ุจุนุถ ุงูููุงุทู",
                        cameraIssue: "ูุนู",
                        internetAvailability: "ุฌูุฏ",
                        timestamp: new Date().toLocaleString('ar-SA')
                    },
                    {
                        name: "ูุญูุฏ ุงููุฑูุณู",
                        major: "ููุฏุณุฉ ุงูุญุงุณุจ",
                        academicLevel: "ุณูุฉ ุซุงูุซุฉ",
                        overallSatisfaction: "ูุฑุชูุน ุฌุฏุงู",
                        featureLectures: 4,
                        featureAttendance: 5,
                        featureMonitoring: 5,
                        featureExams: 4,
                        featureActivities: 4,
                        biggestChallenge: "ูุดุงูู ูู ูุงููุฑุง ุงููุงุชู",
                        cameraIssue: "ูุนู",
                        internetAvailability: "ููุชุงุฒ",
                        timestamp: new Date().toLocaleString('ar-SA')
                    }
                ],
                professors: [
                    {
                        name: "ุฏ. ุฃุญูุฏ ูุงุณู",
                        department: "ุนููู ุงูุญุงุณุจ",
                        teachingExperience: "ุฃูุซุฑ ูู 15 ุณูุฉ",
                        systemUsefulness: "ูููุฏ ุฌุฏุงู",
                        reqLectures: 5,
                        reqAttendance: 5,
                        reqMonitoring: 5,
                        reqExams: 4,
                        reqActivities: 4,
                        biggestObstacle: "ุตุนูุจุฉ ูุชุงุจุนุฉ ุญุถูุฑ ุงูุทูุงุจ",
                        attendanceProblems: "ุฃุญูุงูุงู",
                        timestamp: new Date().toLocaleString('ar-SA')
                    }
                ],
                totals: {
                    students: 2,
                    professors: 1,
                    total: 3
                }
            };
        }

        function createMockReportAnalysis(data) {
            return {
                summary: {
                    totalParticipants: data.totals.total,
                    studentCount: data.totals.students,
                    professorCount: data.totals.professors,
                    completionRate: "100%",
                    averageTime: "8.5",
                    database: "MongoDB Atlas"
                },
                charts: {
                    satisfactionLevels: { "ูุฑุชูุน ุฌุฏุงู": 1, "ูุฑุชูุน": 2 },
                    featureRankings: {
                        "ูุธุงู ุงูุชุญุถูุฑ ุงูุขูู": 5.0,
                        "ูุธุงู ูุฑุงูุจุฉ ุงูุงุฎุชุจุงุฑุงุช": 4.7,
                        "ูุธุงู ุฅุฏุงุฑุฉ ุงููุญุงุถุฑุงุช": 4.5,
                        "ูุธุงู ุฅุฏุงุฑุฉ ุงูุงุฎุชุจุงุฑุงุช": 4.0,
                        "ูุธุงู ุฅุฏุงุฑุฉ ุงูุฃูุดุทุฉ": 3.5
                    },
                    byMajor: { "ุนููู ุงูุญุงุณุจ": 1, "ููุฏุณุฉ ุงูุญุงุณุจ": 1 },
                    byDepartment: { "ุนููู ุงูุญุงุณุจ": 1 },
                    cameraIssues: { "ูุนู": 2, "ูุง": 0, "ุฃุญูุงูุงู": 0 },
                    internetQuality: { "ููุชุงุฒ": 1, "ุฌูุฏ": 1, "ุถุนูู": 0 }
                },
                insights: [
                    "100% ูู ุงูุทูุงุจ ูุนุงููู ูู ูุดุงูู ูู ูุงููุฑุงุช ููุงุชููู",
                    "ูุธุงู ุงูุชุญุถูุฑ ุงูุขูู ูู ุงูุฃูุซุฑ ุฃูููุฉ ุจูุณุจุฉ 5/5",
                    "ุงูููุฆุฉ ุงูุชุฏุฑูุณูุฉ ุชูุงุฌู ุตุนูุจุฉ ูู ูุชุงุจุนุฉ ุงูุญุถูุฑ",
                    "ุงูุจูุงูุงุช ูุงููุฉ ูุจุฏุก ุงูุชุญููู ุงูุฅุญุตุงุฆู"
                ]
            };
        }

        // ==================== ุฃุฌุฒุงุก ุงูุชูุฑูุฑ ====================
        function updateReportDates() {
            const now = new Date();
            const hijriDate = now.toLocaleDateString('ar-SA', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById('reportDate').textContent = hijriDate;
            document.getElementById('dataCollectionPeriod').textContent = '30 ููู';
        }

        function generateTableOfContents() {
            const sections = [
                { title: 'ุงูููุฎุต ุงูุชูููุฐู', id: 'executiveSummary' },
                { title: 'ูููุฌูุฉ ุงูุจุญุซ', id: 'researchMethodology' },
                { title: 'ุงููุชุงุฆุฌ ูุงูุฅุญุตุงุฆูุงุช', id: 'generalStats' },
                { title: 'ุชุญููู ุงูููุฒุงุช ุงูููุชุฑุญุฉ', id: 'featuresAnalysis' },
                { title: 'ุงูุชุญุฏูุงุช ูุงููุดุงูู ุงููุญุฏุฏุฉ', id: 'challengesAnalysis' },
                { title: 'ุงูุชูุตูุงุช ูุงูููุชุฑุญุงุช', id: 'mainRecommendations' },
                { title: 'ุงูุฎุงุชูุฉ', id: 'conclusion' }
            ];
            
            const tocHTML = sections.map((section, index) => `
                <div style="margin-bottom: 12px; padding-right: 20px; border-right: 3px solid #3498db;">
                    <a href="#${section.id}" style="color: #1a2980; text-decoration: none; font-weight: 500; display: block; padding: 8px 0;">
                        ${index + 1}. ${section.title}
                    </a>
                </div>
            `).join('');
            
            document.getElementById('tableOfContents').innerHTML = tocHTML;
        }

        function generateExecutiveSummary(data, analysis) {
            const totalParticipants = data.totals.total || 0;
            const positivePercentage = analysis.charts.satisfactionLevels ? 
                ((analysis.charts.satisfactionLevels['ูุฑุชูุน ุฌุฏุงู'] || 0) + (analysis.charts.satisfactionLevels['ูุฑุชูุน'] || 0)) / totalParticipants * 100 : 0;
            
            const summary = `
                <p>ููุฏู ูุฐุง ุงูุจุญุซ ุฅูู ุฏุฑุงุณุฉ ุฌุฏูู ูุชูููู ุงุญุชูุงุฌุงุช ูุธุงู ุฅุฏุงุฑุฉ ุชุนูู ุฅููุชุฑููู ูุชูุงูู (LMS) 
                ููุจู ูุชุทูุจุงุช ุงูุนูููุฉ ุงูุชุนููููุฉ ุงูุญุฏูุซุฉ. ุชู ุฌูุน ุงูุจูุงูุงุช ูู <strong>${totalParticipants}</strong> ูุดุงุฑูุงู 
                ูู ุทูุงุจ ูููุฆุฉ ุชุฏุฑูุณูุฉ ูู ุงูุฌุงูุนุฉ ุงููุฌุงุญ.</p>
                
                <div style="margin: 25px 0; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                    <h4 style="color: #1a2980; margin-bottom: 15px;"><i class="fas fa-chart-line"></i> ุงููุชุงุฆุฌ ุงูุฑุฆูุณูุฉ</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #1a2980;">${totalParticipants}</div>
                            <div style="color: #666;">ุฅุฌูุงูู ุงููุดุงุฑููู</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #2ecc71;">${positivePercentage.toFixed(1)}%</div>
                            <div style="color: #666;">ุงูุฑุถุง ุงูุฅูุฌุงุจู</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.8em; font-weight: bold; color: #3498db;">5 ุฃูุธูุฉ</div>
                            <div style="color: #666;">ููุฒุงุช ููุชุฑุญุฉ</div>
                        </div>
                    </div>
                </div>
                
                <p>ุฃุธูุฑุช ุงููุชุงุฆุฌ ุฃู <strong>${positivePercentage.toFixed(1)}%</strong> ูู ุงููุดุงุฑููู ุฃุนุฑุจูุง ุนู ุฑุถุง ุฅูุฌุงุจู 
                ุนู ููุฑุฉ ุงููุธุงู ุงูููุชุฑุญุ ูุน ุชุฃููุฏ ุฃูููุฉ ุงูููุฒุงุช ุงููุชูุฏูุฉ ูุซู ูุธุงู ุงูุชุญุถูุฑ ุงูุขูู 
                ููุฑุงูุจุฉ ุงูุงุฎุชุจุงุฑุงุช ุงูุนูููุฉ.</p>
                
                <p>ุชู ุชุญุฏูุฏ <strong>"ูุธุงู ุงูุชุญุถูุฑ ุงูุขูู"</strong> ูุฃูู ููุฒุฉ ูุทููุจุฉ ูู ูุจู ุงููุณุชุฎุฏูููุ 
                ููุง ูุฏู ุนูู ุงูุญุงุฌุฉ ุงูููุญุฉ ููุธุงู ูุชูุงูู ูุญู ูุดุงูู ุงูุชุนููู ุงูุฅููุชุฑููู ุงูุญุงููุฉ 
                ุฎุงุตุฉ ูููุง ูุชุนูู ุจูุชุงุจุนุฉ ุงูุญุถูุฑ ูุงูุชูููู.</p>
                
                <p>ูุฎูุต ุงูุจุญุซ ุฅูู ุฌุฏูู ุชุทุจูู ุงููุธุงู ุงูููุชุฑุญ ูุน ุชูุฏูู ุชูุตูุงุช ุนูููุฉ ูุถูุงู ูุฌุงุญ 
                ุงูุชุทุจูู ูุงูุงุณุชูุงุฏุฉ ุงููุตูู ูู ููุฒุงุชู ุงููุชูุฏูุฉ ูู ุฑูุน ููุงุกุฉ ุงูุนูููุฉ ุงูุชุนููููุฉ.</p>
            `;
            
            document.getElementById('executiveSummary').innerHTML = summary;
        }

        function generateResearchMethodology(data) {
            const methodology = `
                <p>ุงุนุชูุฏ ุงูุจุญุซ ุนูู ุงููููุฌ ุงููุตูู ุงูุชุญููููุ ุญูุซ ุชู ุชุตููู ุฃุฏุงุชูู ุฑุฆูุณูุชูู ูุฌูุน ุงูุจูุงูุงุช ูู ูุฆุชูู ูุณุชูุฏูุชูู:</p>
                
                <div class="stats-grid" style="margin: 25px 0;">
                    <div class="stat-box success">
                        <div class="stat-number">${data.totals.students || 0}</div>
                        <div class="stat-label">ุทุงูุจ</div>
                    </div>
                    <div class="stat-box danger">
                        <div class="stat-number">${data.totals.professors || 0}</div>
                        <div class="stat-label">ุนุถู ููุฆุฉ ุชุฏุฑูุณ</div>
                    </div>
                    <div class="stat-box primary">
                        <div class="stat-number">${data.totals.total || 0}</div>
                        <div class="stat-label">ุฅุฌูุงูู ุงููุดุงุฑููู</div>
                    </div>
                </div>
                
                <p>ุชู ุงุฎุชูุงุฑ ุงูุนููุฉ ุนุดูุงุฆูุงู ูู ูุฌุชูุน ุงูุจุญุซ ุงูุฐู ูุดูู ุทูุงุจ ูููุฆุฉ ุชุฏุฑูุณูุฉ ูู 
                ุงูุฌุงูุนุฉ ุงููุฌุงุญ. ุงุนุชูุฏ ุงูุจุญุซ ุนูู ูููุฌูุฉ ุนูููุฉ ุชุถููุช:</p>
                
                <ul class="features-list" style="margin-top: 20px;">
                    <li><i class="fas fa-check feature-icon"></i> ุชุตููู ุงุณุชุจูุงูุงุช ูุชุฎุตุตุฉ ููู ูุฆุฉ</li>
                    <li><i class="fas fa-check feature-icon"></i> ุงุณุชุฎุฏุงู ูุธุงู ุฅููุชุฑููู ูุชูุงูู ูุฌูุน ุงูุจูุงูุงุช</li>
                    <li><i class="fas fa-check feature-icon"></i> ูุงุนุฏุฉ ุจูุงูุงุช MongoDB Atlas ููุชุฎุฒูู ุงูุขูู</li>
                    <li><i class="fas fa-check feature-icon"></i> ุชุญููู ุฅุญุตุงุฆู ูุชูุฏู ูููุชุงุฆุฌ</li>
                    <li><i class="fas fa-check feature-icon"></i> ุถูุงุจุท ุฃุฎูุงููุฉ ุชุถูู ุณุฑูุฉ ุงูุจูุงูุงุช</li>
                </ul>
            `;
            
            document.getElementById('researchMethodology').innerHTML = methodology;
        }

        function generateGeneralStats(data, analysis) {
            const statsHTML = `
                <div class="stat-box primary">
                    <div class="stat-number">${data.totals.total || 0}</div>
                    <div class="stat-label">ุฅุฌูุงูู ุงููุดุงุฑููู</div>
                </div>
                <div class="stat-box success">
                    <div class="stat-number">${data.totals.students || 0}</div>
                    <div class="stat-label">ุนุฏุฏ ุงูุทูุงุจ</div>
                </div>
                <div class="stat-box danger">
                    <div class="stat-number">${data.totals.professors || 0}</div>
                    <div class="stat-label">ุนุฏุฏ ุงูููุฆุฉ ุงูุชุฏุฑูุณูุฉ</div>
                </div>
                <div class="stat-box warning">
                    <div class="stat-number">${analysis.summary.completionRate || '100%'}</div>
                    <div class="stat-label">ูุนุฏู ุฅููุงู ุงูุงุณุชุจูุงู</div>
                </div>
            `;
            
            document.getElementById('generalStats').innerHTML = statsHTML;
        }

        function generateStudentsAnalysis(data) {
            const students = data.students || [];
            const majors = {};
            students.forEach(student => {
                const major = student.major || 'ุบูุฑ ูุญุฏุฏ';
                majors[major] = (majors[major] || 0) + 1;
            });
            
            const topMajor = Object.entries(majors).sort(([,a], [,b]) => b - a)[0] || ['ุบูุฑ ูุญุฏุฏ', 0];
            const majorPercentage = students.length ? ((topMajor[1] / students.length) * 100).toFixed(1) : 0;
            
            const analysis = `
                <p>ูุดูู ุงูุทูุงุจ <strong>${students.length ? ((students.length / data.totals.total) * 100).toFixed(1) : 0}%</strong> 
                ูู ุนููุฉ ุงูุฏุฑุงุณุฉ. ุชูุซู ุชุฎุตุต <strong>${topMajor[0]}</strong> ุงููุณุจุฉ ุงูุฃูุจุฑ ุจูุณุจุฉ 
                <strong>${majorPercentage}%</strong>.</p>
                
                <div style="margin: 20px 0; padding: 15px; background: #f0f7ff; border-radius: 8px; border-right: 4px solid #3498db;">
                    <h4 style="color: #1a2980; margin-bottom: 10px;"><i class="fas fa-chart-bar"></i> ุชูุฒูุน ุงูุทูุงุจ ุญุณุจ ุงูุชุฎุตุต</h4>
                    ${Object.entries(majors).map(([major, count]) => `
                        <div style="margin-bottom: 8px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <span>${major}</span>
                                <span style="font-weight: bold;">${count}</span>
                            </div>
                            <div style="height: 6px; background: #e0e0e0; border-radius: 3px; overflow: hidden;">
                                <div style="height: 100%; width: ${(count / students.length) * 100}%; background: #3498db;"></div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <p>ุฃุธูุฑุช ูุชุงุฆุฌ ุงุณุชุจูุงู ุงูุทูุงุจ ุงูุชูุงูุงู ูุจูุฑุงู ุจููุฒุงุช ุงููุธุงู ุงูููุชุฑุญุ ุฎุงุตุฉ:</p>
                
                <ul class="features-list">
                    <li><i class="fas fa-mobile-alt feature-icon"></i> ูุธุงู ุงูุชุญุถูุฑ ุงูุขูู (ุชูุถูู QR Code ูุงูุชุญุถูุฑ ุงูุชููุงุฆู)</li>
                    <li><i class="fas fa-wifi feature-icon"></i> ุฅููุงููุฉ ุงูุนูู ุจุฏูู ุฅูุชุฑูุช ููููุงุทู ุงููุงุฆูุฉ</li>
                    <li><i class="fas fa-bolt feature-icon"></i> ุณุฑุนุฉ ุงูุญุตูู ุนูู ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุงุช</li>
                    <li><i class="fas fa-shield-alt feature-icon"></i> ูุธุงู ูุฑุงูุจุฉ ุนุงุฏู ููุงุฎุชุจุงุฑุงุช ุงูุนูููุฉ</li>
                </ul>
            `;
            
            document.getElementById('studentsAnalysis').innerHTML = analysis;
        }

        function generateProfessorsAnalysis(data) {
            const professors = data.professors || [];
            const experience = {};
            professors.forEach(prof => {
                const exp = prof.teachingExperience || 'ุบูุฑ ูุญุฏุฏ';
                experience[exp] = (experience[exp] || 0) + 1;
            });
            
            const topExperience = Object.entries(experience).sort(([,a], [,b]) => b - a)[0] || ['ุบูุฑ ูุญุฏุฏ', 0];
            const expPercentage = professors.length ? ((topExperience[1] / professors.length) * 100).toFixed(1) : 0;
            
            const analysis = `
                <p>ุชูุซู ุงูููุฆุฉ ุงูุชุฏุฑูุณูุฉ <strong>${professors.length ? ((professors.length / data.totals.total) * 100).toFixed(1) : 0}%</strong> 
                ูู ุนููุฉ ุงูุฏุฑุงุณุฉ. <strong>${topExperience[1]}</strong> ูุดุงุฑูุงู ูุฏููู ุฎุจุฑุฉ 
                <strong>${topExperience[0]}</strong> ูู ุงูุชุฏุฑูุณ (${expPercentage}%).</p>
                
                <div style="margin: 20px 0; padding: 15px; background: #fff8e1; border-radius: 8px; border-right: 4px solid #f1c40f;">
                    <h4 style="color: #1a2980; margin-bottom: 10px;"><i class="fas fa-user-tie"></i> ุฎุจุฑุฉ ุงูููุฆุฉ ุงูุชุฏุฑูุณูุฉ</h4>
                    ${Object.entries(experience).map(([exp, count]) => `
                        <div style="margin-bottom: 8px;">
                            <div style="display: flex; justify-content: space-between;">
                                <span>${exp}</span>
                                <span style="font-weight: bold;">${count}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <p>ุฑูุฒุช ุงูุชูุงูุงุช ุงูููุฆุฉ ุงูุชุฏุฑูุณูุฉ ุนูู:</p>
                
                <ul class="features-list">
                    <li><i class="fas fa-eye feature-icon"></i> ูุธุงู ูุฑุงูุจุฉ ุงูุงุฎุชุจุงุฑุงุช ูููุงูุญุฉ ุงูุบุด</li>
                    <li><i class="fas fa-chart-line feature-icon"></i> ุชูุงุฑูุฑ ุชุญููููุฉ ููุตูุฉ ูุฃุฏุงุก ุงูุทูุงุจ</li>
                    <li><i class="fas fa-cogs feature-icon"></i> ุณูููุฉ ุฅุฏุงุฑุฉ ุงููุญุชูู ุงูุชุนูููู</li>
                    <li><i class="fas fa-clock feature-icon"></i> ุชูููุฑ ุงูููุช ูู ุนูููุงุช ุงูุชุญุถูุฑ ูุงูุชูููู</li>
                </ul>
            `;
            
            document.getElementById('professorsAnalysis').innerHTML = analysis;
        }

        function generateFeaturesAnalysis(analysis) {
            const features = analysis.charts.featureRankings || {};
            const sortedFeatures = Object.entries(features)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 8);
            
            const featuresHTML = sortedFeatures.map(([feature, rating], index) => `
                <tr>
                    <td>${feature}</td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="font-weight: bold; color: ${getRatingColor(rating)}">${rating}</div>
                            <div style="flex-grow: 1; height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden;">
                                <div style="height: 100%; width: ${(rating / 5) * 100}%; background: ${getRatingColor(rating)};"></div>
                            </div>
                        </div>
                    </td>
                    <td>${index + 1}</td>
                    <td>${getFeatureNotes(feature, rating)}</td>
                </tr>
            `).join('');
            
            document.getElementById('featuresAnalysis').innerHTML = `
                <thead>
                    <tr>
                        <th>ุงูููุฒุฉ</th>
                        <th>ูุชูุณุท ุงูุฃูููุฉ</th>
                        <th>ุชุฑุชูุจ ุงูุฃููููุฉ</th>
                        <th>ููุงุญุธุงุช</th>
                    </tr>
                </thead>
                <tbody>
                    ${featuresHTML}
                </tbody>
            `;
        }

        function getRatingColor(rating) {
            if (rating >= 4.5) return '#2ecc71';
            if (rating >= 4.0) return '#3498db';
            if (rating >= 3.5) return '#f1c40f';
            if (rating >= 3.0) return '#e67e22';
            return '#e74c3c';
        }

        function getFeatureNotes(feature, rating) {
            const notes = {
                'ูุธุงู ุงูุชุญุถูุฑ ุงูุขูู': rating >= 4.5 ? 'ุฃููููุฉ ูุตูู ูููุณุชุฎุฏููู' : 'ููู ูููู ูุญุชุงุฌ ุชุญุณูู',
                'ูุธุงู ูุฑุงูุจุฉ ุงูุงุฎุชุจุงุฑุงุช': rating >= 4.5 ? 'ุญู ุฃุณุงุณู ููุดููุฉ ุงูุบุด' : 'ููุฒุฉ ููููุฉ',
                'ูุธุงู ุฅุฏุงุฑุฉ ุงููุญุงุถุฑุงุช': rating >= 4.0 ? 'ุฃุณุงุณู ููุชุนููู ุนู ุจุนุฏ' : 'ูููุฏ ูููู ููุณ ุฃุณุงุณูุงู',
                'ูุธุงู ุฅุฏุงุฑุฉ ุงูุงุฎุชุจุงุฑุงุช': rating >= 4.0 ? 'ูุญุณู ููุงุกุฉ ุงูุชูููู' : 'ููุฒุฉ ูุณุงุนุฏุฉ',
                'ูุธุงู ุฅุฏุงุฑุฉ ุงูุฃูุดุทุฉ': rating >= 3.5 ? 'ูุญุณู ูุชุงุจุนุฉ ุงูุชูุฏู' : 'ููุฒุฉ ุซุงูููุฉ'
            };
            
            return notes[feature] || (rating >= 4.0 ? 'ููุฒุฉ ุฃุณุงุณูุฉ' : 'ููุฒุฉ ุฏุงุนูุฉ');
        }

        function generateChallengesAnalysis(analysis) {
            const insights = analysis.insights || [];
            
            const challengesHTML = insights.length > 0 ? insights.map(insight => `
                <p style="margin-bottom: 12px; padding: 12px; background: #fff5f5; border-radius: 8px; border-right: 3px solid #e74c3c;">
                    <i class="fas fa-exclamation-circle" style="color: #e74c3c; margin-left: 10px;"></i>
                    ${insight}
                </p>
            `).join('') : '<p>ูุง ุชูุฌุฏ ุชุญุฏูุงุช ูุญุฏุฏุฉ ูู ุงูุจูุงูุงุช ุงูุญุงููุฉ.</p>';
            
            document.getElementById('challengesAnalysis').innerHTML = challengesHTML;
            
            // ุงููุดุงูู ุงูุชูููุฉ
            const techProblems = analysis.charts.cameraIssues || {};
            const problemsHTML = Object.entries(techProblems).map(([problem, count]) => `
                <li>
                    <i class="fas fa-mobile-alt feature-icon"></i>
                    <div>
                        <strong>${problem}:</strong> ${count} ุทุงูุจ
                        ${analysis.summary.studentCount ? `(${Math.round((count / analysis.summary.studentCount) * 100)}%)` : ''}
                    </div>
                </li>
            `).join('');
            
            document.getElementById('technicalProblems').innerHTML = problemsHTML || '<li>ูุง ุชูุฌุฏ ูุดุงูู ุชูููุฉ ูุณุฌูุฉ</li>';
            
            // ุงูุชุญุฏูุงุช ุงูุฑุฆูุณูุฉ
            const mainChallenges = insights.filter(insight => 
                insight.includes('ูุดุงูู') || 
                insight.includes('ุชุญุฏูุงุช') || 
                insight.includes('ููุงุฌู')
            ).slice(0, 5);
            
            const challengesListHTML = mainChallenges.map(challenge => `
                <div class="recommendation-item">${challenge}</div>
            `).join('');
            
            document.getElementById('mainChallenges').innerHTML = challengesListHTML || 
                '<div class="recommendation-item">ูุง ุชูุฌุฏ ุชุญุฏูุงุช ุฑุฆูุณูุฉ ูุญุฏุฏุฉ</div>';
        }

        function generateRecommendations(analysis) {
            const recommendations = `
                <div class="recommendation-item">ุชุทููุฑ ูุธุงู ุชุญุถูุฑ ุขูู ูุชูุฏู ูุนูู ุจู QR Code ูุงูุชุญุถูุฑ ุงูุชููุงุฆู</div>
                <div class="recommendation-item">ุชูููุฑ ูุธุงู ูุนูู ุจุฏูู ุฅูุชุฑูุช ููุทูุงุจ ูู ุงูููุงุทู ุงููุงุฆูุฉ</div>
                <div class="recommendation-item">ุชุฏุฑูุจ ุงูููุฆุฉ ุงูุชุฏุฑูุณูุฉ ุนูู ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฌุฏูุฏ</div>
                <div class="recommendation-item">ุชุทููุฑ ุชุทุจูู ูุญููู ุณูู ุงูุงุณุชุฎุฏุงู</div>
                <div class="recommendation-item">ุฅูุดุงุก ูุฑูุฒ ุฏุนู ููู ูุชุฎุตุต</div>
                <div class="recommendation-item">ุชุทููุฑ ูุธุงู ูุฑุงูุจุฉ ุฐูู ููุงุฎุชุจุงุฑุงุช ุงูุนูููุฉ</div>
                <div class="recommendation-item">ุชูููุฑ ุชูุงุฑูุฑ ุชุญููููุฉ ููุตูุฉ ูุฃุฏุงุก ุงูุทูุงุจ</div>
            `;
            
            document.getElementById('mainRecommendations').innerHTML = recommendations;
            
            // ุฎุทูุงุช ุงูุชูููุฐ
            const steps = `
                <li>ุฅุนุฏุงุฏ ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุชูููุฉ ูุงูุฎูุงุฏู</li>
                <li>ุชุทููุฑ ุงููููุฐุฌ ุงูุฃููู (Prototype) ูููุธุงู</li>
                <li>ุงุฎุชุจุงุฑ ุงููุธุงู ูุน ูุฌููุนุฉ ูุณุชุฎุฏููู ูุญุฏูุฏุฉ</li>
                <li>ุชุญููู ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ ูุฅุฌุฑุงุก ุงูุชุญุณููุงุช ุงููุงุฒูุฉ</li>
                <li>ุงูุชุฏุฑูุจ ุงูุดุงูู ูููุณุชุฎุฏููู (ุทูุงุจ ูููุฆุฉ ุชุฏุฑูุณูุฉ)</li>
                <li>ุงูุชุทุจูู ุงููุงูู ุนูู ูุณุชูู ุงููุคุณุณุฉ ุงูุชุนููููุฉ</li>
                <li>ุงููุชุงุจุนุฉ ูุงูุชูููู ุงููุณุชูุฑ ุจุนุฏ ุงูุชุทุจูู</li>
            `;
            
            document.getElementById('implementationSteps').innerHTML = steps;
        }

        function generateConclusion(data, analysis) {
            const totalParticipants = data.totals.total || 0;
            const positiveFeedback = analysis.charts.satisfactionLevels ? 
                ((analysis.charts.satisfactionLevels['ูุฑุชูุน ุฌุฏุงู'] || 0) + (analysis.charts.satisfactionLevels['ูุฑุชูุน'] || 0)) : 0;
            const positivePercentage = totalParticipants ? ((positiveFeedback / totalParticipants) * 100).toFixed(1) : 0;
            
            const conclusion = `
                <p>ูุคูุฏ ูุฐุง ุงูุจุญุซ ุนูู ุงูุญุงุฌุฉ ุงูููุญุฉ ููุธุงู ุฅุฏุงุฑุฉ ุชุนูู ุฅููุชุฑููู ูุชูุงูู 
                ูุญู ุงููุดุงูู ุงูุชูููุฏูุฉ ูู ุงูุชุนููู ุงูุฅููุชุฑููู. ุงููุชุงุฆุฌ ุชุดูุฑ ุฅูู ูุจูู ุนุงูู 
                ูููุฑุฉ ุงููุธุงู ูู ูุจู ุฌููุน ูุฆุงุช ุงููุณุชุฎุฏููู.</p>
                
                <div style="margin: 25px 0; padding: 20px; background: linear-gradient(135deg, #2ecc71, #1abc9c); color: white; border-radius: 10px;">
                    <h4 style="color: white; margin-bottom: 15px;"><i class="fas fa-chart-line"></i> ูุคุดุฑุงุช ุงููุฌุงุญ</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; text-align: center;">
                        <div>
                            <div style="font-size: 1.5em; font-weight: bold;">${positivePercentage}%</div>
                            <div>ูุนุฏู ุงูุฑุถุง ุงูุฅูุฌุงุจู</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5em; font-weight: bold;">${totalParticipants}</div>
                            <div>ุญุฌู ุงูุนููุฉ</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5em; font-weight: bold;">5/5</div>
                            <div>ุฃูููุฉ ุงูุชุญุถูุฑ ุงูุขูู</div>
                        </div>
                    </div>
                </div>
                
                <p>ูุน ูุดุงุฑูุฉ <strong>${totalParticipants}</strong> ูุฑุฏุงู ูู ุงูุฏุฑุงุณุฉุ 
                ูุฑุถุง ุฅูุฌุงุจู ุจูุณุจุฉ <strong>${positivePercentage}%</strong>ุ 
                ูููู ุงุนุชูุงุฏ ูุชุงุฆุฌ ูุฐุง ุงูุจุญุซ ูุฃุณุงุณ ุนููู ูุชุทููุฑ ุงููุธุงู ุงูููุชุฑุญ.</p>
                
                <p>ููุตู ุงูุจุญุซ ุจุงููุถู ูุฏูุงู ูู ูุฑุญูุฉ ุงูุชุทููุฑ ุงููุนูู ูููุธุงูุ 
                ูุน ุงูุชุฑููุฒ ุนูู ุงูููุฒุงุช ุฐุงุช ุงูุฃููููุฉ ุงูุนุงููุฉ ููุง ุญุฏุฏูุง ุงููุณุชุฎุฏูููุ 
                ูุฎุงุตุฉ ูุธุงู ุงูุชุญุถูุฑ ุงูุขูู ููุธุงู ูุฑุงูุจุฉ ุงูุงุฎุชุจุงุฑุงุช.</p>
                
                <div style="margin-top: 30px; padding: 20px; background: #1a2980; color: white; border-radius: 10px;">
                    <h4 style="color: white; margin-bottom: 15px;"><i class="fas fa-graduation-cap"></i> ุงููููุฉ ุงููุถุงูุฉ</h4>
                    <p>ูุฐุง ุงููุธุงู ููุณ ูุฌุฑุฏ ุฃุฏุงุฉ ุชูููุฉุ ุจู ูู ูููุฉ ููุนูุฉ ูู ุชุฌุฑุจุฉ ุงูุชุนููู ุงูุฅููุชุฑููู
                    ุชุณุงูู ูู ุฑูุน ุฌูุฏุฉ ุงููุฎุฑุฌุงุช ุงูุชุนููููุฉ ูููุงูุจุฉ ูุชุทูุจุงุช ุงูุนุตุฑ ุงูุฑูููุ
                    ูุชุถุน ุงูุฌุงูุนุฉ ูู ูุตุงู ุงููุคุณุณุงุช ุงูุชุนููููุฉ ุงููุชูุฏูุฉ ุชูููุงู.</p>
                </div>
            `;
            
            document.getElementById('conclusion').innerHTML = conclusion;
        }

        function calculatePageCount() {
            setTimeout(() => {
                const contentHeight = document.getElementById('reportContent').scrollHeight;
                const pageHeight = 297; // A4 height in mm
                const pageCount = Math.max(12, Math.ceil(contentHeight / (pageHeight * 3.78)));
                document.getElementById('pageCount').textContent = pageCount;
            }, 1000);
        }

        function showErrorMessage(message) {
            const errorHTML = `
                <div style="text-align: center; padding: 40px; color: #e74c3c;">
                    <i class="fas fa-exclamation-triangle" style="font-size: 3em; margin-bottom: 20px;"></i>
                    <h3>${message}</h3>
                    <p style="margin-top: 20px; color: #666;">
                        <button onclick="refreshReport()" style="background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            <i class="fas fa-redo"></i> ุญุงูู ูุฑุฉ ุฃุฎุฑู
                        </button>
                    </p>
                </div>
            `;
            
            // ุฅุธูุงุฑ ุงูุฑุณุงูุฉ ูู ุงูุฃูุณุงู ุงูุฑุฆูุณูุฉ
            ['executiveSummary', 'researchMethodology', 'studentsAnalysis', 'professorsAnalysis'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.innerHTML = errorHTML;
            });
        }

        // ==================== ูุธุงุฆู ูุณุงุนุฏุฉ ====================
        function refreshReport() {
            console.log('๐ ุชุญุฏูุซ ุงูุชูุฑูุฑ...');
            
            // ุฅุนุงุฏุฉ ุชุนููู ุญุงูุฉ ุงูุชุญููู
            document.querySelectorAll('.loading').forEach(el => {
                el.innerHTML = '<i class="fas fa-spinner fa-spin"></i><br>ุฌุงุฑู ุงูุชุญููู...';
            });
            
            // ุฅุนุงุฏุฉ ุชุญููู ุงูุจูุงูุงุช
            setTimeout(generateReport, 500);
        }

        function exportReport() {
            alert('ููุฒุฉ ุชุตุฏูุฑ PDF ููุฏ ุงูุชุทููุฑ. ุงุณุชุฎุฏู ุฒุฑ ุงูุทุจุงุนุฉ (Ctrl+P) ูุญูุธ ุงูุชูุฑูุฑ ูู PDF.');
            window.print();
        }

        // ุชุญุฏูุซ ุญุงูุฉ ุงููุธุงู ูู ุฏูููุฉ
        setInterval(checkSystemStatus, 60000);
        
        // ุชุญุฏูุซ ููุช ุงูุชูุฑูุฑ ูู 5 ุฏูุงุฆู
        setInterval(() => {
            document.getElementById('lastUpdate').textContent = 
                new Date().toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' });
        }, 300000);

        // ุฅุธูุงุฑ ุฑุณุงูุฉ ุนูุฏ ูุญุงููุฉ ุงูุฎุฑูุฌ
        window.addEventListener('beforeunload', function (e) {
            e.preventDefault();
            e.returnValue = 'ูู ุชุฑูุฏ ูุบุงุฏุฑุฉ ุตูุญุฉ ุงูุชูุฑูุฑุ ูุฏ ุชููุฏ ุงูุชุบููุฑุงุช ุบูุฑ ุงููุญููุธุฉ.';
        });
    </script>
</body>
</html>
